<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Use Cases &mdash; EOS 1.0.2 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/contentui.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    <link rel="canonical" href="https://eos.github.io/doc/use-cases.html" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/contentui.js"></script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Advanced Usage" href="advanced.html" />
    <link rel="prev" title="Basics" href="basics.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> EOS
            <img src="_static/github-eos-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">Basics</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Use Cases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#theory-predictions-and-their-uncertainties">Theory Predictions and their Uncertainties</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#listing-the-built-in-observables">Listing the built-in Observables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#constructing-and-evaluating-an-observable">Constructing and Evaluating an Observable</a></li>
<li class="toctree-l3"><a class="reference internal" href="#estimating-theoretical-uncertainties">Estimating Theoretical Uncertainties</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#parameter-inference">Parameter Inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#listing-the-built-in-constraints">Listing the built-in Constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="#visualizing-the-built-in-constraints">Visualizing the built-in Constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="#defining-the-statistical-analysis">Defining the Statistical Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sampling-from-the-posterior">Sampling from the Posterior</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pseudo-event-simulation">Pseudo Event Simulation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#listing-the-built-in-probability-density-functions">Listing the built-in Probability Density Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#constructing-a-1d-pdf-and-simulating-pseudo-events">Constructing a 1D PDF and Simulating Pseudo Events</a></li>
<li class="toctree-l3"><a class="reference internal" href="#comparing-the-1d-pdf-pseudo-events-with-the-analytic-result">Comparing the 1D PDF pseudo events with the analytic result</a></li>
<li class="toctree-l3"><a class="reference internal" href="#constructing-a-4d-pdf-and-simulating-pseudo-events">Constructing a 4D PDF and Simulating Pseudo Events</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/python.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="constraints.html">List of Constraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="observables.html">List of Observables</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameters.html">List of Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">List of References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">EOS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Use Cases</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="use-cases">
<h1>Use Cases<a class="headerlink" href="#use-cases" title="Permalink to this headline"></a></h1>
<section id="theory-predictions-and-their-uncertainties">
<h2>Theory Predictions and their Uncertainties<a class="headerlink" href="#theory-predictions-and-their-uncertainties" title="Permalink to this headline"></a></h2>
<p>EOS can produce theory predictions for any of its built-in observables.
The examples following in this section illustrate how to find a specific observable from the list of all built-in observables,
construct an <a class="reference internal" href="api/python.html#eos.Observable" title="eos.Observable"><code class="xref py py-class docutils literal notranslate"><span class="pre">Observable</span></code></a> object and evaluate it,
and estimate the theoretical uncertainties associated with it.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following examples are intended to be run in an interactive <a class="reference external" href="https://jupyter.org/">Jupyter</a> notebook.
The entire notebook can be obtained <a class="reference external" href="https://github.com/eos/eos/blob/master/examples/predictions.ipynb">from here</a>.</p>
</div>
<section id="listing-the-built-in-observables">
<h3>Listing the built-in Observables<a class="headerlink" href="#listing-the-built-in-observables" title="Permalink to this headline"></a></h3>
<p>The full list of built-in observables for the most-recent EOS release is available online <a class="reference external" href="https://eos.github.io/doc/observables">here</a>.
For an interactive approach to see the list of observables available to you, run the following in a Jupyter notebook</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">eos</span>
<span class="n">display</span><span class="p">(</span><span class="n">eos</span><span class="o">.</span><span class="n">Observables</span><span class="p">())</span>
</pre></div>
</div>
<p>Searching for a specific observable is possible by filtering for specific strings in the observable name’s <cite>prefix</cite>, <cite>name</cite>, or <cite>suffix</cite> parts. The
following example only shows observables that contain a <cite>‘A_FB</cite>’ in the name part, and <cite>‘B-&gt;pi</cite> in the prefix part, and <cite>‘Untagged’</cite> in the suffix part.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">eos</span><span class="o">.</span><span class="n">Observables</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;A_FB&#39;</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">eos</span><span class="o">.</span><span class="n">Observables</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;B-&gt;pi&#39;</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">eos</span><span class="o">.</span><span class="n">Observables</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;Untagged&#39;</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="constructing-and-evaluating-an-observable">
<h3>Constructing and Evaluating an Observable<a class="headerlink" href="#constructing-and-evaluating-an-observable" title="Permalink to this headline"></a></h3>
<p>To make theory predictions of any observable, EOS requires its full name, its <a class="reference internal" href="api/python.html#eos.Parameters" title="eos.Parameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a> object,
its <a class="reference internal" href="api/python.html#eos.Kinematics" title="eos.Kinematics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Kinematics</span></code></a> object, and its <a class="reference internal" href="api/python.html#eos.Options" title="eos.Options"><code class="xref py py-class docutils literal notranslate"><span class="pre">Options</span></code></a> object.
As an example, we will use the integrated branching ratio of <span class="math notranslate nohighlight">\(\bar{B}\to D\ell^-\bar\nu\)</span>,
which is represented by the <a class="reference internal" href="api/python.html#eos.QualifiedName" title="eos.QualifiedName"><code class="xref py py-class docutils literal notranslate"><span class="pre">QualifiedName</span></code></a> <code class="docutils literal notranslate"><span class="pre">B-&gt;Dlnu::BR</span></code>.
Additional information about any given observable can be obtained by displaying the full database entry,
which also contains information about the kinematic variables required:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">eos</span><span class="o">.</span><span class="n">Observables</span><span class="p">()[</span><span class="s1">&#39;B-&gt;Dlnu::BR&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>which outputs the following table:</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Qualified Name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">B-&gt;Dlnu::BR</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p><span class="math notranslate nohighlight">\(\mathcal{B}(\bar{B}\to D\ell^-\bar\nu)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Kinematic Variable</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">q2_min</span></code>, <code class="docutils literal notranslate"><span class="pre">q2_max</span></code></p></td>
</tr>
</tbody>
</table>
<p>From this output we understand that <code class="docutils literal notranslate"><span class="pre">B-&gt;Dlnu::BR</span></code> expects two kinematic variables,
corresponding here to the lower and upper integration boundaries of the dilepton invariant mass <span class="math notranslate nohighlight">\(q^2\)</span>.</p>
<p>We proceed to create an <a class="reference internal" href="api/python.html#eos.Observable" title="eos.Observable"><code class="xref py py-class docutils literal notranslate"><span class="pre">Obervable</span></code></a> object with the default set of parameters and options,
and then display it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">Parameters</span><span class="o">.</span><span class="n">Defaults</span><span class="p">()</span>
<span class="n">kinematics</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">Kinematics</span><span class="p">(</span><span class="n">q2_min</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">q2_max</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">Observable</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;B-&gt;Dlnu::BR&#39;</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">kinematics</span><span class="p">,</span> <span class="n">eos</span><span class="o">.</span><span class="n">Options</span><span class="p">())</span>
<span class="n">display</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
</pre></div>
</div>
<p>The default options select <span class="math notranslate nohighlight">\(\ell=\mu\)</span> as the lepton flavor. The value of the observable
is shown to be about <span class="math notranslate nohighlight">\(2.4\%\)</span>, which is compatible with the current world average for the <span class="math notranslate nohighlight">\(\bar{B}^-\to D^0\mu^-\bar\nu\)</span> branching ratio.</p>
<p>By setting the <code class="docutils literal notranslate"><span class="pre">l</span></code> option to the value <code class="docutils literal notranslate"><span class="pre">'tau'</span></code>, we have create a different observable representing the <span class="math notranslate nohighlight">\(\bar{B}^-\to D^0\tau^-\bar\nu\)</span> branching ratio.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">Parameters</span><span class="o">.</span><span class="n">Defaults</span><span class="p">()</span>
<span class="n">kinematics</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">Kinematics</span><span class="p">(</span><span class="n">q2_min</span><span class="o">=</span><span class="mf">3.17</span><span class="p">,</span> <span class="n">q2_max</span><span class="o">=</span><span class="mf">11.60</span><span class="p">)</span>
<span class="n">obs</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">Observable</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;B-&gt;Dlnu::BR&#39;</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">kinematics</span><span class="p">,</span> <span class="n">eos</span><span class="o">.</span><span class="n">Options</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="s1">&#39;tau&#39;</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
</pre></div>
</div>
<p>The new observable yields a value of <span class="math notranslate nohighlight">\(0.69\%\)</span>.</p>
<p>So far we evaluated the integrated branching ratio. EOS also provides the corresponding differential branching ratio
as a function of the squared momentum transfer <span class="math notranslate nohighlight">\(q^2\)</span>.
The differential branching fraction is accessible through the name <code class="docutils literal notranslate"><span class="pre">B-&gt;Dlnu::dBR/dq2</span></code>. To illustrate it, we use EOS’s plot functions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;plot&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$q^2$&#39;</span><span class="p">,</span> <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\textnormal</span><span class="si">{GeV}</span><span class="s1">^2$&#39;</span><span class="p">,</span> <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">11.60</span><span class="p">]</span> <span class="p">},</span>
        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$d\mathcal</span><span class="si">{B}</span><span class="s1">/dq^2$&#39;</span><span class="p">,</span>                    <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">5e-3</span><span class="p">]</span> <span class="p">},</span>
        <span class="s1">&#39;legend&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="s1">&#39;upper center&#39;</span> <span class="p">}</span>
    <span class="p">},</span>
    <span class="s1">&#39;contents&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\ell=\mu$&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;observable&#39;</span><span class="p">,</span>
            <span class="s1">&#39;observable&#39;</span><span class="p">:</span> <span class="s1">&#39;B-&gt;Dlnu::dBR/dq2;l=mu&#39;</span><span class="p">,</span>
            <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;q2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">11.60</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\ell=\tau$&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;observable&#39;</span><span class="p">,</span>
            <span class="s1">&#39;observable&#39;</span><span class="p">:</span> <span class="s1">&#39;B-&gt;Dlnu::dBR/dq2;l=tau&#39;</span><span class="p">,</span>
            <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;q2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.17</span><span class="p">,</span> <span class="mf">11.60</span><span class="p">],</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
<span class="n">eos</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">plot_args</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>which yields:</p>
<a class="reference internal image-reference" href="_images/use-cases_prediction_plot-example.png"><img alt="_images/use-cases_prediction_plot-example.png" src="_images/use-cases_prediction_plot-example.png" style="width: 600px;" /></a>
</section>
<section id="estimating-theoretical-uncertainties">
<h3>Estimating Theoretical Uncertainties<a class="headerlink" href="#estimating-theoretical-uncertainties" title="Permalink to this headline"></a></h3>
<p>To estimate theoretical uncertainties of the observables, EOS uses Bayesian statistics.
The latter interprets the theory parameters as random variables and assigns <em>a priori</em> probability density functions (prior PDFs) for each parameter.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For technical reasons, EOS can only use uncorrelated prior PDFs.
The same effects as having correlated prior PDFs can be achieved by using a correlated likelihood and uniform prior PDFs.</p>
</div>
<p>We carry on using the integrated branching ratios of <span class="math notranslate nohighlight">\(\bar{B}^-\to D^0\left\lbrace\mu^-, \tau^-\right\rbrace\bar\nu\)</span> decays as examples.
The largest source of theoretical uncertainty in these decays arises from the hadronic matrix elements, i.e.,
from the form factors <span class="math notranslate nohighlight">\(f^{B\to \bar{D}}_+(q^2)\)</span> and <span class="math notranslate nohighlight">\(f^{B\to \bar{D}}_0(q^2)\)</span>.
Both form factors have been obtained independently using lattice QCD simulations by the HPQCD and Fermilab/MILC (FNAL+MILC) collaborations.
The joint likelihoods for both form factors at different <span class="math notranslate nohighlight">\(q^2\)</span> values of each prediction are available in EOS
as <code class="xref py py-class docutils literal notranslate"><span class="pre">Constraint</span></code> objects under the names <code class="docutils literal notranslate"><span class="pre">B-&gt;D::f_++f_0&#64;HPQCD:2015A</span></code> and <code class="docutils literal notranslate"><span class="pre">B-&gt;D::f_++f_0&#64;FNAL+MILC:2015B</span></code>.
We will discuss such constraints in more detail in the section <a class="reference internal" href="#parameter-inference">Parameter Inference</a>.
For this example, we will use both the HPQCD and FNAL+MILC results and create a combined likelihood as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">analysis_args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;global_options&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;priors&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s1">&#39;parameter&#39;</span><span class="p">:</span> <span class="s1">&#39;B-&gt;D::alpha^f+_0@BSZ2015&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>  <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span>  <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform&#39;</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s1">&#39;parameter&#39;</span><span class="p">:</span> <span class="s1">&#39;B-&gt;D::alpha^f+_1@BSZ2015&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="o">+</span><span class="mf">5.0</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform&#39;</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s1">&#39;parameter&#39;</span><span class="p">:</span> <span class="s1">&#39;B-&gt;D::alpha^f+_2@BSZ2015&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="o">+</span><span class="mf">5.0</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform&#39;</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s1">&#39;parameter&#39;</span><span class="p">:</span> <span class="s1">&#39;B-&gt;D::alpha^f0_1@BSZ2015&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="o">+</span><span class="mf">5.0</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform&#39;</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s1">&#39;parameter&#39;</span><span class="p">:</span> <span class="s1">&#39;B-&gt;D::alpha^f0_2@BSZ2015&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="o">+</span><span class="mf">5.0</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform&#39;</span> <span class="p">}</span>
    <span class="p">],</span>
    <span class="s1">&#39;likelihood&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;B-&gt;D::f_++f_0@HPQCD:2015A&#39;</span><span class="p">,</span>
        <span class="s1">&#39;B-&gt;D::f_++f_0@FNAL+MILC:2015B&#39;</span>
    <span class="p">]</span>
<span class="p">}</span>
<span class="n">analysis</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">Analysis</span><span class="p">(</span><span class="o">**</span><span class="n">analysis_args</span><span class="p">)</span>
</pre></div>
</div>
<p>Next we create three observables: the semi-muonic branching ratio, the semi-tauonic branching ratio,
and the ratio of the former two. By using <code class="code docutils literal notranslate"><span class="pre">analysis.parameter</span></code> in the construction of these
observables, we ensure that all observables and the Analysis object share the same parameter set.
This means that changes to the <a class="reference internal" href="api/python.html#eos.Analysis" title="eos.Analysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">Analysis</span></code></a>’ parameters will affect the evaluation
of all three observables.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">obs_mu</span>  <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">Observable</span><span class="o">.</span><span class="n">make</span><span class="p">(</span>
    <span class="s1">&#39;B-&gt;Dlnu::BR&#39;</span><span class="p">,</span>
    <span class="n">analysis</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span>
    <span class="n">eos</span><span class="o">.</span><span class="n">Kinematics</span><span class="p">(</span><span class="n">q2_min</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">q2_max</span><span class="o">=</span><span class="mf">11.60</span><span class="p">),</span>
    <span class="n">eos</span><span class="o">.</span><span class="n">Options</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;l&#39;</span><span class="p">:</span><span class="s1">&#39;mu&#39;</span><span class="p">,</span> <span class="s1">&#39;form-factors&#39;</span><span class="p">:</span><span class="s1">&#39;BSZ2015&#39;</span><span class="p">})</span>
<span class="p">)</span>
<span class="n">obs_tau</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">Observable</span><span class="o">.</span><span class="n">make</span><span class="p">(</span>
    <span class="s1">&#39;B-&gt;Dlnu::BR&#39;</span><span class="p">,</span>
    <span class="n">analysis</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span>
    <span class="n">eos</span><span class="o">.</span><span class="n">Kinematics</span><span class="p">(</span><span class="n">q2_min</span><span class="o">=</span><span class="mf">3.17</span><span class="p">,</span> <span class="n">q2_max</span><span class="o">=</span><span class="mf">11.60</span><span class="p">),</span>
    <span class="n">eos</span><span class="o">.</span><span class="n">Options</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;l&#39;</span><span class="p">:</span><span class="s1">&#39;tau&#39;</span><span class="p">,</span><span class="s1">&#39;form-factors&#39;</span><span class="p">:</span><span class="s1">&#39;BSZ2015&#39;</span><span class="p">})</span>
<span class="p">)</span>
<span class="n">obs_R_D</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">Observable</span><span class="o">.</span><span class="n">make</span><span class="p">(</span>
    <span class="s1">&#39;B-&gt;Dlnu::R_D&#39;</span><span class="p">,</span>
    <span class="n">analysis</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span>
    <span class="n">eos</span><span class="o">.</span><span class="n">Kinematics</span><span class="p">(</span><span class="n">q2_mu_min</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">q2_mu_max</span><span class="o">=</span><span class="mf">11.60</span><span class="p">,</span> <span class="n">q2_tau_min</span><span class="o">=</span><span class="mf">3.17</span><span class="p">,</span> <span class="n">q2_tau_max</span><span class="o">=</span><span class="mf">11.60</span><span class="p">),</span>
    <span class="n">eos</span><span class="o">.</span><span class="n">Options</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;form-factors&#39;</span><span class="p">:</span><span class="s1">&#39;BSZ2015&#39;</span><span class="p">})</span>
<span class="p">)</span>
<span class="n">observables</span><span class="o">=</span><span class="p">(</span><span class="n">obs_mu</span><span class="p">,</span> <span class="n">obs_tau</span><span class="p">,</span> <span class="n">obs_R_D</span><span class="p">)</span>
</pre></div>
</div>
<p>In the above, we made sure to provide the option <code class="code docutils literal notranslate"><span class="pre">form-factors=BSZ2015</span></code> to ensure that the right form factor plugin is used.</p>
<p>Sampling from the log(posterior) and – at the same time – producing posterior-predictive samples of the <code class="code docutils literal notranslate"><span class="pre">observables</span></code> is achieved by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parameter_samples</span><span class="p">,</span> <span class="n">log_weights</span><span class="p">,</span> <span class="n">observable_samples</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">pre_N</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">observables</span><span class="o">=</span><span class="n">observables</span><span class="p">)</span>
</pre></div>
</div>
<p>Here <code class="code docutils literal notranslate"><span class="pre">N=5000</span></code> samples are produced. To illustrate these samples we use EOS’ plotting framework:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;plot&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$d\mathcal</span><span class="si">{B}</span><span class="s1">/dq^2$&#39;</span><span class="p">,</span>  <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">3e-2</span><span class="p">]</span> <span class="p">},</span>
        <span class="s1">&#39;legend&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="s1">&#39;upper center&#39;</span> <span class="p">}</span>
    <span class="p">},</span>
    <span class="s1">&#39;contents&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\ell=\mu$&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;histogram&#39;</span><span class="p">,</span> <span class="s1">&#39;bins&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="n">observable_samples</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;log_weights&#39;</span><span class="p">:</span> <span class="n">log_weights</span> <span class="p">}},</span>
        <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\ell=\tau$&#39;</span><span class="p">,</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;histogram&#39;</span><span class="p">,</span> <span class="s1">&#39;bins&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="n">observable_samples</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;log_weights&#39;</span><span class="p">:</span> <span class="n">log_weights</span> <span class="p">}},</span>
    <span class="p">]</span>
<span class="p">}</span>
<span class="n">eos</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">plot_args</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/use-cases_prediction_hist-b-to-d-l-nu.png"><img alt="_images/use-cases_prediction_hist-b-to-d-l-nu.png" src="_images/use-cases_prediction_hist-b-to-d-l-nu.png" style="width: 600px;" /></a>
<p>We can convince ourselves of the usefullness of the correlated samples by computing the lepton-flavor universality
ratio <span class="math notranslate nohighlight">\(R_D\)</span> twice: once using EOS’ built-in observable <code class="code docutils literal notranslate"><span class="pre">B-&gt;Dlnu::R_D</span></code> as sampled above,
and once by calculating the ratio manually for each sample:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;plot&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$d\mathcal</span><span class="si">{B}</span><span class="s1">/dq^2$&#39;</span><span class="p">,</span>  <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.28</span><span class="p">,</span>  <span class="mf">0.32</span><span class="p">]</span> <span class="p">},</span>
        <span class="s1">&#39;legend&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="s1">&#39;upper left&#39;</span> <span class="p">}</span>
    <span class="p">},</span>
    <span class="s1">&#39;contents&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$R_D$ (EOS)&#39;</span><span class="p">,</span>     <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;histogram&#39;</span><span class="p">,</span> <span class="s1">&#39;bins&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="n">observable_samples</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="p">}},</span>
        <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$R_D$ (manually)&#39;</span><span class="p">,</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;histogram&#39;</span><span class="p">,</span> <span class="s1">&#39;bins&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">o</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">o</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">observable_samples</span><span class="p">[:]]</span> <span class="p">},</span>
          <span class="s1">&#39;histtype&#39;</span><span class="p">:</span> <span class="s1">&#39;step&#39;</span><span class="p">},</span>
    <span class="p">]</span>
<span class="p">}</span>
<span class="n">eos</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">plot_args</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/use-cases_prediction_hist-r-d.png"><img alt="_images/use-cases_prediction_hist-r-d.png" src="_images/use-cases_prediction_hist-r-d.png" style="width: 600px;" /></a>
<p>Using the Numpy routines <code class="code docutils literal notranslate"><span class="pre">numpy.average</span></code> and <code class="code docutils literal notranslate"><span class="pre">numpy.var</span></code> we can produce numerical estimates
of the mean and the standard deviation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{obs}</span><span class="s1">;</span><span class="si">{opt}</span><span class="s1">  = </span><span class="si">{mean:.4f}</span><span class="s1"> +/- </span><span class="si">{std:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">obs</span><span class="o">=</span><span class="n">obs_mu</span><span class="o">.</span><span class="n">name</span><span class="p">(),</span> <span class="n">opt</span><span class="o">=</span><span class="n">obs_mu</span><span class="o">.</span><span class="n">options</span><span class="p">(),</span>
    <span class="n">mean</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">observable_samples</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_weights</span><span class="p">)),</span>
    <span class="n">std</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">observable_samples</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]))</span>
<span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{obs}</span><span class="s1">;</span><span class="si">{opt}</span><span class="s1"> = </span><span class="si">{mean:.4f}</span><span class="s1"> +/- </span><span class="si">{std:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">obs</span><span class="o">=</span><span class="n">obs_tau</span><span class="o">.</span><span class="n">name</span><span class="p">(),</span> <span class="n">opt</span><span class="o">=</span><span class="n">obs_tau</span><span class="o">.</span><span class="n">options</span><span class="p">(),</span>
    <span class="n">mean</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">observable_samples</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_weights</span><span class="p">)),</span>
    <span class="n">std</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">observable_samples</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{obs}</span><span class="s1">;</span><span class="si">{opt}</span><span class="s1">      = </span><span class="si">{mean:.4f}</span><span class="s1"> +/- </span><span class="si">{std:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">obs</span><span class="o">=</span><span class="n">obs_R_D</span><span class="o">.</span><span class="n">name</span><span class="p">(),</span> <span class="n">opt</span><span class="o">=</span><span class="n">obs_R_D</span><span class="o">.</span><span class="n">options</span><span class="p">(),</span>
    <span class="n">mean</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">observable_samples</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_weights</span><span class="p">)),</span>
    <span class="n">std</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">observable_samples</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="p">))</span>
</pre></div>
</div>
<p>From the above we obtain:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="o">-&gt;</span><span class="n">Dlnu</span><span class="p">::</span><span class="n">BR</span><span class="p">;</span><span class="n">form</span><span class="o">-</span><span class="n">factors</span><span class="o">=</span><span class="n">BSZ2015</span><span class="p">,</span><span class="n">l</span><span class="o">=</span><span class="n">mu</span>  <span class="o">=</span> <span class="mf">0.0235</span> <span class="o">+/-</span> <span class="mf">0.0007</span>
<span class="n">B</span><span class="o">-&gt;</span><span class="n">Dlnu</span><span class="p">::</span><span class="n">BR</span><span class="p">;</span><span class="n">form</span><span class="o">-</span><span class="n">factors</span><span class="o">=</span><span class="n">BSZ2015</span><span class="p">,</span><span class="n">l</span><span class="o">=</span><span class="n">tau</span> <span class="o">=</span> <span class="mf">0.0071</span> <span class="o">+/-</span> <span class="mf">0.0001</span>
<span class="n">B</span><span class="o">-&gt;</span><span class="n">Dlnu</span><span class="p">::</span><span class="n">R_D</span><span class="p">;</span><span class="n">form</span><span class="o">-</span><span class="n">factors</span><span class="o">=</span><span class="n">BSZ2015</span>      <span class="o">=</span> <span class="mf">0.3014</span> <span class="o">+/-</span> <span class="mf">0.0001</span>
</pre></div>
</div>
<p>To obtain uncertainty bands for a plot of the differential branching ratios, we can now produce a
sequence of observables at different points in phase space. We then pass these observables on to
<a class="reference internal" href="api/python.html#eos.Analysis.sample" title="eos.Analysis.sample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample</span></code></a>, to obtain posterior-predictive samples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mu_q2values</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span>  <span class="mf">1.00</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1.00</span><span class="p">,</span> <span class="mf">11.60</span><span class="p">,</span> <span class="mi">20</span><span class="p">))))</span>
<span class="n">mu_obs</span>       <span class="o">=</span> <span class="p">[</span><span class="n">eos</span><span class="o">.</span><span class="n">Observable</span><span class="o">.</span><span class="n">make</span><span class="p">(</span>
                   <span class="s1">&#39;B-&gt;Dlnu::dBR/dq2&#39;</span><span class="p">,</span> <span class="n">analysis</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="n">eos</span><span class="o">.</span><span class="n">Kinematics</span><span class="p">(</span><span class="n">q2</span><span class="o">=</span><span class="n">q2</span><span class="p">),</span>
                   <span class="n">eos</span><span class="o">.</span><span class="n">Options</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;form-factors&#39;</span><span class="p">:</span> <span class="s1">&#39;BSZ2015&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="s1">&#39;mu&#39;</span><span class="p">}))</span>
               <span class="k">for</span> <span class="n">q2</span> <span class="ow">in</span> <span class="n">mu_q2values</span><span class="p">]</span>
<span class="n">tau_q2values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">3.17</span><span class="p">,</span> <span class="mf">11.60</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">tau_obs</span>      <span class="o">=</span> <span class="p">[</span><span class="n">eos</span><span class="o">.</span><span class="n">Observable</span><span class="o">.</span><span class="n">make</span><span class="p">(</span>
                   <span class="s1">&#39;B-&gt;Dlnu::dBR/dq2&#39;</span><span class="p">,</span> <span class="n">analysis</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="n">eos</span><span class="o">.</span><span class="n">Kinematics</span><span class="p">(</span><span class="n">q2</span><span class="o">=</span><span class="n">q2</span><span class="p">),</span>
                   <span class="n">eos</span><span class="o">.</span><span class="n">Options</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;form-factors&#39;</span><span class="p">:</span> <span class="s1">&#39;BSZ2015&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="s1">&#39;tau&#39;</span><span class="p">}))</span>
               <span class="k">for</span> <span class="n">q2</span> <span class="ow">in</span> <span class="n">tau_q2values</span><span class="p">]</span>
<span class="n">_</span><span class="p">,</span> <span class="n">log_weights</span><span class="p">,</span> <span class="n">mu_samples</span>  <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">pre_N</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">observables</span><span class="o">=</span><span class="n">mu_obs</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">log_weights</span><span class="p">,</span> <span class="n">tau_samples</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">pre_N</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">observables</span><span class="o">=</span><span class="n">tau_obs</span><span class="p">)</span>
</pre></div>
</div>
<p>We can plot the so-obtained posterior-predictive samples with EOS’ plotting framework by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;plot&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$q^2$&#39;</span><span class="p">,</span> <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\textnormal</span><span class="si">{GeV}</span><span class="s1">^2$&#39;</span><span class="p">,</span> <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">11.60</span><span class="p">]</span> <span class="p">},</span>
        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$d\mathcal</span><span class="si">{B}</span><span class="s1">/dq^2$&#39;</span><span class="p">,</span>                    <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">5e-3</span><span class="p">]</span> <span class="p">},</span>
        <span class="s1">&#39;legend&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="s1">&#39;upper center&#39;</span> <span class="p">}</span>
    <span class="p">},</span>
    <span class="s1">&#39;contents&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\ell=\mu$&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;uncertainty&#39;</span><span class="p">,</span> <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">11.60</span><span class="p">],</span>
          <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="n">mu_samples</span><span class="p">,</span> <span class="s1">&#39;xvalues&#39;</span><span class="p">:</span> <span class="n">mu_q2values</span> <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\ell=\tau$&#39;</span><span class="p">,</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;uncertainty&#39;</span><span class="p">,</span> <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.17</span><span class="p">,</span> <span class="mf">11.60</span><span class="p">],</span>
          <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="n">tau_samples</span><span class="p">,</span> <span class="s1">&#39;xvalues&#39;</span><span class="p">:</span> <span class="n">tau_q2values</span> <span class="p">}</span>
        <span class="p">},</span>
    <span class="p">]</span>
<span class="p">}</span>
<span class="n">eos</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">plot_args</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/use-cases_prediction_plot-uncertainty.png"><img alt="_images/use-cases_prediction_plot-uncertainty.png" src="_images/use-cases_prediction_plot-uncertainty.png" style="width: 600px;" /></a>
</section>
</section>
<section id="parameter-inference">
<h2>Parameter Inference<a class="headerlink" href="#parameter-inference" title="Permalink to this headline"></a></h2>
<p>EOS can infer parameters based on a database of experimental or theoretical constraints and its built-in observables.
The examples following in this section illustrate how to find a specific constraint from the list of all built-in constraints,
construct an <a class="reference internal" href="api/python.html#eos.Analysis" title="eos.Analysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">Analysis</span></code></a> object that represents the statistical analysis,
and infer mean value and standard deviation of a list of parameters through optimization or Monte Carlo methods.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following examples are intended to be run in an interactive <a class="reference external" href="https://jupyter.org/">Jupyter</a> notebook.
The entire notebook can be obtained <a class="reference external" href="https://github.com/eos/eos/blob/master/examples/inference.ipynb">from here</a>.</p>
</div>
<section id="listing-the-built-in-constraints">
<h3>Listing the built-in Constraints<a class="headerlink" href="#listing-the-built-in-constraints" title="Permalink to this headline"></a></h3>
<p>The full list of built-in constraints for the most-recent EOS release is available online <a class="reference external" href="https://eos.github.io/doc/constraints">here</a>.
For an interactive approach to see the list of constraints available to you, run the following in a Jupyter notebook:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">eos</span>
<span class="n">display</span><span class="p">(</span><span class="n">eos</span><span class="o">.</span><span class="n">Constraints</span><span class="p">())</span>
</pre></div>
</div>
<p>Searching for a specific observable is possible by filtering for specific strings in the constraint name’s <cite>prefix</cite>, <cite>name</cite>, or <cite>suffix</cite> parts.
The following example only show constraints that contain <cite>‘B^0-&gt;D^+’</cite> in the prefix part:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">eos</span><span class="o">.</span><span class="n">Constraints</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;B^0-&gt;D^+&#39;</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="visualizing-the-built-in-constraints">
<h3>Visualizing the built-in Constraints<a class="headerlink" href="#visualizing-the-built-in-constraints" title="Permalink to this headline"></a></h3>
<p>For what follows we will use the two experimental constraints <code class="docutils literal notranslate"><span class="pre">B^0-&gt;D^+e^-nu::BRs&#64;Belle:2015A</span></code> and <code class="docutils literal notranslate"><span class="pre">B^0-&gt;D^+mu^-nu::BRs&#64;Belle:2015A</span></code>,
to infer the CKM matrix element <span class="math notranslate nohighlight">\(|V_{cb}|\)</span>. We can readily display these two constraints, along with the default theory prediction,
using the following code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;plot&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$q^2$&#39;</span><span class="p">,</span> <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\textnormal</span><span class="si">{GeV}</span><span class="s1">^2$&#39;</span><span class="p">,</span> <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">11.63</span><span class="p">]</span> <span class="p">},</span>
        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$d\mathcal</span><span class="si">{B}</span><span class="s1">/dq^2$&#39;</span><span class="p">,</span>                    <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">5e-3</span><span class="p">]</span> <span class="p">},</span>
        <span class="s1">&#39;legend&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="s1">&#39;lower left&#39;</span> <span class="p">}</span>
    <span class="p">},</span>
    <span class="s1">&#39;contents&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\ell=e$&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;observable&#39;</span><span class="p">,</span>
            <span class="s1">&#39;observable&#39;</span><span class="p">:</span> <span class="s1">&#39;B-&gt;Dlnu::dBR/dq2;l=e,q=d&#39;</span><span class="p">,</span>
            <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;q2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>
            <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">11.63</span><span class="p">],</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Belle 2015 $\ell=e,\, q=d$&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;constraint&#39;</span><span class="p">,</span>
            <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;C0&#39;</span><span class="p">,</span>
            <span class="s1">&#39;constraints&#39;</span><span class="p">:</span> <span class="s1">&#39;B^0-&gt;D^+e^-nu::BRs@Belle:2015A&#39;</span><span class="p">,</span>
            <span class="s1">&#39;observable&#39;</span><span class="p">:</span> <span class="s1">&#39;B-&gt;Dlnu::BR&#39;</span><span class="p">,</span>
            <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;q2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;rescale-by-width&#39;</span><span class="p">:</span> <span class="kc">False</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Belle 2015 $\ell=\mu,\,q=d$&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;constraint&#39;</span><span class="p">,</span>
            <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;constraints&#39;</span><span class="p">:</span> <span class="s1">&#39;B^0-&gt;D^+mu^-nu::BRs@Belle:2015A&#39;</span><span class="p">,</span>
            <span class="s1">&#39;observable&#39;</span><span class="p">:</span> <span class="s1">&#39;B-&gt;Dlnu::BR&#39;</span><span class="p">,</span>
            <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;q2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;rescale-by-width&#39;</span><span class="p">:</span> <span class="kc">False</span>
        <span class="p">},</span>
    <span class="p">]</span>
<span class="p">}</span>
<span class="n">eos</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">plot_args</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>The resulting plot looks like this:</p>
<a class="reference internal image-reference" href="_images/use-cases_inference_plot-a-priori.png"><img alt="_images/use-cases_inference_plot-a-priori.png" src="_images/use-cases_inference_plot-a-priori.png" style="width: 600px;" /></a>
</section>
<section id="defining-the-statistical-analysis">
<h3>Defining the Statistical Analysis<a class="headerlink" href="#defining-the-statistical-analysis" title="Permalink to this headline"></a></h3>
<p>To define our statistical analysis for the inference of <span class="math notranslate nohighlight">\(|V_{cb}|\)</span> from <span class="math notranslate nohighlight">\(\bar{B}\to D\ell^-\bar\nu\)</span> branching ratios,
some decisions are needed.
First, we must decide how to parametrize the hadronic form factors that emerge in semileptonic <span class="math notranslate nohighlight">\(\bar{B}\to D\)</span> transitions.
For what follows we will use the <a class="reference internal" href="references.html#bsz-2015a" id="id4"><span>[BSZ:2015A]</span></a> parametrization.
Next, we must decide the theory input for the form factors. For what follows we will combine the correlated lattice QCD results published by the Fermilab/MILC and HPQCD collaborations in 2015.</p>
<p>We then create an <a class="reference internal" href="api/python.html#eos.Analysis" title="eos.Analysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">Analysis</span></code></a> object as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">analysis_args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;global_options&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;form-factors&#39;</span><span class="p">:</span> <span class="s1">&#39;BSZ2015&#39;</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;CKM&#39;</span> <span class="p">},</span>
    <span class="s1">&#39;priors&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s1">&#39;parameter&#39;</span><span class="p">:</span> <span class="s1">&#39;CKM::abs(V_cb)&#39;</span><span class="p">,</span>           <span class="s1">&#39;min&#39;</span><span class="p">:</span>  <span class="mf">38e-3</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span>  <span class="mf">45e-3</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform&#39;</span><span class="p">},</span>
        <span class="p">{</span> <span class="s1">&#39;parameter&#39;</span><span class="p">:</span> <span class="s1">&#39;B-&gt;D::alpha^f+_0@BSZ2015&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span>  <span class="mf">0.0</span><span class="p">,</span>   <span class="s1">&#39;max&#39;</span><span class="p">:</span>  <span class="mf">1.0</span><span class="p">,</span>   <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform&#39;</span><span class="p">},</span>
        <span class="p">{</span> <span class="s1">&#39;parameter&#39;</span><span class="p">:</span> <span class="s1">&#39;B-&gt;D::alpha^f+_1@BSZ2015&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.0</span><span class="p">,</span>   <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>   <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform&#39;</span><span class="p">},</span>
        <span class="p">{</span> <span class="s1">&#39;parameter&#39;</span><span class="p">:</span> <span class="s1">&#39;B-&gt;D::alpha^f+_2@BSZ2015&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="o">+</span><span class="mf">4.0</span><span class="p">,</span>   <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="o">+</span><span class="mf">6.0</span><span class="p">,</span>   <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform&#39;</span><span class="p">},</span>
        <span class="p">{</span> <span class="s1">&#39;parameter&#39;</span><span class="p">:</span> <span class="s1">&#39;B-&gt;D::alpha^f0_1@BSZ2015&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>   <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="o">+</span><span class="mf">2.0</span><span class="p">,</span>   <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform&#39;</span><span class="p">},</span>
        <span class="p">{</span> <span class="s1">&#39;parameter&#39;</span><span class="p">:</span> <span class="s1">&#39;B-&gt;D::alpha^f0_2@BSZ2015&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span>   <span class="s1">&#39;max&#39;</span><span class="p">:</span>  <span class="mf">0.0</span><span class="p">,</span>   <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform&#39;</span><span class="p">}</span>
    <span class="p">],</span>
    <span class="s1">&#39;likelihood&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;B-&gt;D::f_++f_0@HPQCD:2015A&#39;</span><span class="p">,</span>
        <span class="s1">&#39;B-&gt;D::f_++f_0@FNAL+MILC:2015B&#39;</span><span class="p">,</span>
        <span class="s1">&#39;B^0-&gt;D^+e^-nu::BRs@Belle:2015A&#39;</span><span class="p">,</span>
        <span class="s1">&#39;B^0-&gt;D^+mu^-nu::BRs@Belle:2015A&#39;</span>
    <span class="p">]</span>
<span class="p">}</span>
<span class="n">analysis</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">Analysis</span><span class="p">(</span><span class="o">**</span><span class="n">analysis_args</span><span class="p">)</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;CKM::abs(V_cb)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">42.0e-3</span><span class="p">)</span>
</pre></div>
</div>
<p>In the above, the global options ensure that our choice of form factor parametrization is used throughout,
and that for CKM matrix elements the <cite>CKM</cite> model is used. The latter provides access to <span class="math notranslate nohighlight">\(V_{cb}\)</span> matrix element through two <code class="xref py py-class docutils literal notranslate"><span class="pre">parameters</span></code>:
the absolute value <code class="docutils literal notranslate"><span class="pre">CKM::abs(V_cb)</span></code> and the complex phase <code class="docutils literal notranslate"><span class="pre">CKM::arg(V_cb)</span></code>.
We provide the parameters in our analysis through the specifications of the Bayesian priors.
In the above, each prior is a uniform prior that covers the range from <code class="docutils literal notranslate"><span class="pre">min</span></code> to <code class="docutils literal notranslate"><span class="pre">max</span></code>.
The likelihood is defined through a list constraints, which in the above includes both the experimental measurements by the Belle collaboration as well as the theoretical lattice QCD results.
Finally, we set the starting value of <code class="docutils literal notranslate"><span class="pre">CKM::abs(V_cb)</span></code> to a sensible value of <span class="math notranslate nohighlight">\(42\cdot 10^{-3}\)</span>.</p>
<p>We can now proceed to optimize the log(posterior) through a call to <code class="docutils literal notranslate"><span class="pre">analysis.optimize</span></code>.
In a Jupyter notebook, it is useful to display the return value of this method, which illustrates the best-fit point.
We can further display a summary of the goodness-of-fit information.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bfp</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">bfp</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">analysis</span><span class="o">.</span><span class="n">goodness_of_fit</span><span class="p">())</span>
</pre></div>
</div>
<p>The resulting best-fit point looks like this:</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parameter</p></td>
<td><p>value</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(|V_{cb}|\)</span></p></td>
<td><p>0.0422</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">B-&gt;D::alpha^f+_0&#64;BSZ2015</span></code></p></td>
<td><p>0.6671</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">B-&gt;D::alpha^f+_1&#64;BSZ2015</span></code></p></td>
<td><p>-2.5314</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">B-&gt;D::alpha^f+_2&#64;BSZ2015</span></code></p></td>
<td><p>4.8813</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">B-&gt;D::alpha^f0_1&#64;BSZ2015</span></code></p></td>
<td><p>0.2660</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">B-&gt;D::alpha^f0_2&#64;BSZ2015</span></code></p></td>
<td><p>-0.8410</p></td>
</tr>
</tbody>
</table>
<p>The goodness-of-fit summary consists of a table listing all constraints,</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>constraint</p></td>
<td><p><span class="math notranslate nohighlight">\(\chi^2\)</span></p></td>
<td><p>d.o.f.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">B-&gt;D::f_++f_0&#64;FNAL+MILC:2015B</span></code></p></td>
<td><p>3.4847</p></td>
<td><p>7</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">B-&gt;D::f_++f_0&#64;HPQCD:2015A</span></code></p></td>
<td><p>3.1016</p></td>
<td><p>5</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">B^0-&gt;D^+e^-nu::BRs&#64;Belle:2015A</span></code></p></td>
<td><p>11.8206</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">B^0-&gt;D^+mu^-nu::BRs&#64;Belle:2015A</span></code></p></td>
<td><p>5.2242</p></td>
<td><p>10</p></td>
</tr>
</tbody>
</table>
<p>and the overall information including the p value:</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>total <span class="math notranslate nohighlight">\(\chi^2\)</span></p></td>
<td><p>23.6310</p></td>
</tr>
<tr class="row-even"><td><p>total degrees of freedom</p></td>
<td><p>26</p></td>
</tr>
<tr class="row-odd"><td><p>p-value</p></td>
<td><p>59.7053%</p></td>
</tr>
</tbody>
</table>
</section>
<section id="sampling-from-the-posterior">
<h3>Sampling from the Posterior<a class="headerlink" href="#sampling-from-the-posterior" title="Permalink to this headline"></a></h3>
<p>To sample from the posterior, EOS provides the <a class="reference internal" href="api/python.html#eos.Analysis.sample" title="eos.Analysis.sample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample</span></code></a> method.
Optionally, this can also produce posterior-predictive samples for a list of observables.
We can use these samples to illustrate the results of our fit in relation to the experimental constraints.</p>
<p>For this example, we produce such posterior-predictive samples for the differential <span class="math notranslate nohighlight">\(\bar{B}\to D^+e^-\bar\nu\)</span>
branching ratio in 40 points in the kinematical variable <span class="math notranslate nohighlight">\(q^2\)</span>:; the square of the momentum transfer
to the <span class="math notranslate nohighlight">\(e^-\bar\nu\)</span> pair.
Due to the strong dependence of the branching ratio on <span class="math notranslate nohighlight">\(q^2\)</span>, we do not distribute the points
equally across the full phase space. Instead, we equally distribute half of
the points in the interval <span class="math notranslate nohighlight">\([0.02\,\text{GeV}^2, 1.00\,\text{GeV}^2]\)</span> and the other
half in the remainder of the phase space.</p>
<p>We run one Markov chain to produce <code class="code docutils literal notranslate"><span class="pre">N</span> <span class="pre">=</span> <span class="pre">20000</span></code> samples with a thinning factor (or <code class="code docutils literal notranslate"><span class="pre">stride</span></code>) of 5.
This means that <code class="code docutils literal notranslate"><span class="pre">stride</span> <span class="pre">*</span> <span class="pre">N</span> <span class="pre">=</span> <span class="pre">100000</span></code> samples are produced, but only every 5th sample is returned.
This improves the quality of the samples by reducing the autocorrelation.
Before the samples are produced, the Markov Chain self-adapts in a series of preruns,
the number of which is governed by the <code class="code docutils literal notranslate"><span class="pre">preprun</span></code> argument. In each prerun, <code class="code docutils literal notranslate"><span class="pre">pre_N</span></code>
samples are drawn before the adaptation step. The samples obtained as part of the
preruns are discarded. To ensure efficient sampling, the chain is started in the
best-fit point obtained earlier through optimization.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e_q2values</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span>  <span class="mf">1.00</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1.00</span><span class="p">,</span> <span class="mf">11.60</span><span class="p">,</span> <span class="mi">20</span><span class="p">))))</span>
<span class="n">e_obs</span>       <span class="o">=</span> <span class="p">[</span><span class="n">eos</span><span class="o">.</span><span class="n">Observable</span><span class="o">.</span><span class="n">make</span><span class="p">(</span>
                  <span class="s1">&#39;B-&gt;Dlnu::dBR/dq2&#39;</span><span class="p">,</span> <span class="n">analysis</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="n">eos</span><span class="o">.</span><span class="n">Kinematics</span><span class="p">(</span><span class="n">q2</span><span class="o">=</span><span class="n">q2</span><span class="p">),</span>
                  <span class="n">eos</span><span class="o">.</span><span class="n">Options</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;form-factors&#39;</span><span class="p">:</span> <span class="s1">&#39;BSZ2015&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;q&#39;</span><span class="p">:</span> <span class="s1">&#39;d&#39;</span><span class="p">}))</span>
              <span class="k">for</span> <span class="n">q2</span> <span class="ow">in</span> <span class="n">e_q2values</span><span class="p">]</span>
<span class="n">parameter_samples</span><span class="p">,</span> <span class="n">log_weights</span><span class="p">,</span> <span class="n">e_samples</span>  <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pre_N</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">preruns</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">start_point</span><span class="o">=</span><span class="n">bfp</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">observables</span><span class="o">=</span><span class="n">e_obs</span><span class="p">)</span>
</pre></div>
</div>
<p>The values of the log(posterior) are stored in <code class="code docutils literal notranslate"><span class="pre">log_posterior</span></code>.
The posterior-preditive samples for the observables are stored in <code class="code docutils literal notranslate"><span class="pre">e_samples</span></code>,
and are only returned if the <code class="code docutils literal notranslate"><span class="pre">observables</span></code> keyword argument is provided.</p>
<p>We can illustrate the posterior samples either as a histogram or as a kernel density estimate (KDE) using the built-in plotting functions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;plot&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$|V_</span><span class="si">{cb}</span><span class="s1">|$&#39;</span><span class="p">,</span> <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">38e-3</span><span class="p">,</span> <span class="mf">45e-3</span><span class="p">]</span> <span class="p">},</span>
        <span class="s1">&#39;legend&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="s1">&#39;upper left&#39;</span> <span class="p">}</span>
    <span class="p">},</span>
    <span class="s1">&#39;contents&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;histogram&#39;</span><span class="p">,</span>
            <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="n">parameter_samples</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;log_weights&#39;</span><span class="p">:</span> <span class="n">log_weights</span> <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;kde&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;posterior&#39;</span><span class="p">,</span> <span class="s1">&#39;bandwidth&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">40e-3</span><span class="p">,</span> <span class="mf">45e-3</span><span class="p">],</span>
            <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="n">parameter_samples</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;log_weights&#39;</span><span class="p">:</span> <span class="n">log_weights</span> <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
<span class="n">eos</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">plot_args</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>The result looks like this:</p>
<a class="reference internal image-reference" href="_images/use-cases_inference_hist-Vcb.png"><img alt="_images/use-cases_inference_hist-Vcb.png" src="_images/use-cases_inference_hist-Vcb.png" style="width: 600px;" /></a>
<p>Contours at given levels of posterior probability can be obtained for any pair of parameters using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;plot&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$|V_</span><span class="si">{cb}</span><span class="s1">|$&#39;</span><span class="p">,</span> <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">38e-3</span><span class="p">,</span> <span class="mf">47e-3</span><span class="p">]</span> <span class="p">},</span>
        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$f_+(0)$&#39;</span><span class="p">,</span> <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]</span> <span class="p">},</span>
    <span class="p">},</span>
    <span class="s1">&#39;contents&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;kde2D&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;posterior&#39;</span><span class="p">,</span>
            <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">40e-3</span><span class="p">,</span> <span class="mf">45e-3</span><span class="p">],</span> <span class="s1">&#39;levels&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">68</span><span class="p">,</span> <span class="mi">99</span><span class="p">],</span> <span class="s1">&#39;bandwidth&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="n">parameter_samples</span><span class="p">[:,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="s1">&#39;log_weights&#39;</span><span class="p">:</span> <span class="n">log_weights</span> <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
<span class="n">eos</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">plot_args</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>The result looks like this:</p>
<a class="reference internal image-reference" href="_images/use-cases_inference_hist-Vcb-f_+-zero.png"><img alt="_images/use-cases_inference_hist-Vcb-f_+-zero.png" src="_images/use-cases_inference_hist-Vcb-f_+-zero.png" style="width: 600px;" /></a>
<p>We can visualize the posterior-predictive samples using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;plot&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$q^2$&#39;</span><span class="p">,</span> <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\textnormal</span><span class="si">{GeV}</span><span class="s1">^2$&#39;</span><span class="p">,</span> <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">11.63</span><span class="p">]</span> <span class="p">},</span>
        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$d\mathcal</span><span class="si">{B}</span><span class="s1">/dq^2$&#39;</span><span class="p">,</span>                    <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">5e-3</span><span class="p">]</span> <span class="p">},</span>
        <span class="s1">&#39;legend&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="s1">&#39;lower left&#39;</span> <span class="p">}</span>
    <span class="p">},</span>
    <span class="s1">&#39;contents&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\ell=\mu$&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;uncertainty&#39;</span><span class="p">,</span> <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">11.60</span><span class="p">],</span>
          <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="n">e_samples</span><span class="p">,</span> <span class="s1">&#39;xvalues&#39;</span><span class="p">:</span> <span class="n">e_q2values</span> <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Belle 2015 $\ell=e,\, q=d$&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;constraint&#39;</span><span class="p">,</span>
            <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;C0&#39;</span><span class="p">,</span>
            <span class="s1">&#39;constraints&#39;</span><span class="p">:</span> <span class="s1">&#39;B^0-&gt;D^+e^-nu::BRs@Belle:2015A&#39;</span><span class="p">,</span>
            <span class="s1">&#39;observable&#39;</span><span class="p">:</span> <span class="s1">&#39;B-&gt;Dlnu::BR&#39;</span><span class="p">,</span>
            <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;q2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;rescale-by-width&#39;</span><span class="p">:</span> <span class="kc">False</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Belle 2015 $\ell=\mu,\,q=d$&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;constraint&#39;</span><span class="p">,</span>
            <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;constraints&#39;</span><span class="p">:</span> <span class="s1">&#39;B^0-&gt;D^+mu^-nu::BRs@Belle:2015A&#39;</span><span class="p">,</span>
            <span class="s1">&#39;observable&#39;</span><span class="p">:</span> <span class="s1">&#39;B-&gt;Dlnu::BR&#39;</span><span class="p">,</span>
            <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;q2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;rescale-by-width&#39;</span><span class="p">:</span> <span class="kc">False</span>
        <span class="p">},</span>
    <span class="p">]</span>
<span class="p">}</span>
<span class="n">eos</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">plot_args</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>The result looks like this:</p>
<a class="reference internal image-reference" href="_images/use-cases_inference_plot-a-posteriori.png"><img alt="_images/use-cases_inference_plot-a-posteriori.png" src="_images/use-cases_inference_plot-a-posteriori.png" style="width: 600px;" /></a>
</section>
</section>
<section id="pseudo-event-simulation">
<h2>Pseudo Event Simulation<a class="headerlink" href="#pseudo-event-simulation" title="Permalink to this headline"></a></h2>
<p>EOS can simulate pseudo events from any of its built-in PDFs using Markov chain Monte Carlo techniques.
The examples following in this section illustrate how to find a specific PDF from the list of all built-in PDFs,
simulate the pseudo events from this object, compare to the pseudo events with the analytic results,
and plot 1D and 2D histograms of the pseudo events.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following examples are intended to be run in an interactive <a class="reference external" href="https://jupyter.org/">Jupyter</a> notebook.
The entire notebook can be obtained <a class="reference external" href="https://github.com/eos/eos/blob/master/examples/simulation.ipynb">from here</a>.</p>
</div>
<section id="listing-the-built-in-probability-density-functions">
<h3>Listing the built-in Probability Density Functions<a class="headerlink" href="#listing-the-built-in-probability-density-functions" title="Permalink to this headline"></a></h3>
<p>The full list of built-in PDFs for the most-recent EOS release is available online <a class="reference external" href="https://eos.github.io/doc/signal-pdfs">here</a>.
For an interactive approach to see the list of PDFs available to you, run the following in a Jupyter notebook:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">eos</span>
<span class="n">display</span><span class="p">(</span><span class="n">eos</span><span class="o">.</span><span class="n">SignalPDFs</span><span class="p">())</span>
</pre></div>
</div>
<p>Searching for a specific PDF is possible by filtering for specific strings in the PDF name’s <em>prefix</em>, <em>name</em>, or <em>suffix</em> parts.
The following example only shows PDFs that contain <cite>‘B-&gt;Dlnu’</cite> in the prefix part.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">eos</span><span class="o">.</span><span class="n">SignalPDFs</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;B-&gt;Dlnu&#39;</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="constructing-a-1d-pdf-and-simulating-pseudo-events">
<h3>Constructing a 1D PDF and Simulating Pseudo Events<a class="headerlink" href="#constructing-a-1d-pdf-and-simulating-pseudo-events" title="Permalink to this headline"></a></h3>
<p>We construct the one-dimension PDF describing the decay distribution in the variable <span class="math notranslate nohighlight">\(q^2\)</span> and for <span class="math notranslate nohighlight">\(\ell=\mu\)</span> leptons.
We create the <code class="docutils literal notranslate"><span class="pre">q2</span></code> kinematic variable and set it to an arbitrary starting value.
We set boundaries for the phase space from which we want to sample through the kinematic variables <code class="docutils literal notranslate"><span class="pre">q2_min</span></code> and <code class="docutils literal notranslate"><span class="pre">q2_max</span></code>.
If needed, we can shrink the phase space to a volume smaller than physically allowed. The normalization of the PDF will automatically adapt.</p>
<p>We simulate <code class="docutils literal notranslate"><span class="pre">stride</span> <span class="pre">*</span> <span class="pre">N=250000</span></code> pseudo events/samples from the PDF, which are thinned down to <code class="docutils literal notranslate"><span class="pre">N=50000</span></code>.
The Markov chains can self adapt to the PDF in <code class="docutils literal notranslate"><span class="pre">preruns=3</span></code> preruns with <code class="docutils literal notranslate"><span class="pre">pre_N=1000</span></code> pseudo events/samples each.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mu_kinematics</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">Kinematics</span><span class="p">(</span><span class="o">**</span><span class="p">{</span>
    <span class="s1">&#39;q2&#39;</span><span class="p">:</span>            <span class="mf">2.0</span><span class="p">,</span>  <span class="s1">&#39;q2_min&#39;</span><span class="p">:</span>            <span class="mf">0.02</span><span class="p">,</span>     <span class="s1">&#39;q2_max&#39;</span><span class="p">:</span>           <span class="mf">11.6</span><span class="p">,</span>
<span class="p">})</span>
<span class="n">mu_pdf</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">SignalPDF</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;B-&gt;Dlnu::dGamma/dq2&#39;</span><span class="p">,</span> <span class="n">eos</span><span class="o">.</span><span class="n">Parameters</span><span class="p">(),</span> <span class="n">mu_kinematics</span><span class="p">,</span> <span class="n">eos</span><span class="o">.</span><span class="n">Options</span><span class="p">())</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">mtrand</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">74205</span><span class="p">)</span>
<span class="n">mu_samples</span><span class="p">,</span> <span class="n">mu_weights</span> <span class="o">=</span> <span class="n">mu_pdf</span><span class="o">.</span><span class="n">sample_mcmc</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pre_N</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">preruns</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
</pre></div>
</div>
<p>We repeat the exercise for <span class="math notranslate nohighlight">\(\ell=\tau\)</span> leptons, and adapt the phase space accordingly.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tau_kinematics</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">Kinematics</span><span class="p">(</span><span class="o">**</span><span class="p">{</span>
    <span class="s1">&#39;q2&#39;</span><span class="p">:</span>            <span class="mf">4.0</span><span class="p">,</span>  <span class="s1">&#39;q2_min&#39;</span><span class="p">:</span>            <span class="mf">3.17</span><span class="p">,</span>     <span class="s1">&#39;q2_max&#39;</span><span class="p">:</span>           <span class="mf">11.6</span><span class="p">,</span>
<span class="p">})</span>
<span class="n">tau_pdf</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">SignalPDF</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;B-&gt;Dlnu::dGamma/dq2&#39;</span><span class="p">,</span> <span class="n">eos</span><span class="o">.</span><span class="n">Parameters</span><span class="p">(),</span> <span class="n">tau_kinematics</span><span class="p">,</span> <span class="n">eos</span><span class="o">.</span><span class="n">Options</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="s1">&#39;tau&#39;</span><span class="p">))</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">mtrand</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">74205</span><span class="p">)</span>
<span class="n">tau_samples</span><span class="p">,</span> <span class="n">tau_weights</span> <span class="o">=</span> <span class="n">tau_pdf</span><span class="o">.</span><span class="n">sample_mcmc</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pre_N</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">preruns</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="comparing-the-1d-pdf-pseudo-events-with-the-analytic-result">
<h3>Comparing the 1D PDF pseudo events with the analytic result<a class="headerlink" href="#comparing-the-1d-pdf-pseudo-events-with-the-analytic-result" title="Permalink to this headline"></a></h3>
<p>We can now histogram the pseudo events/samples and compare the histogram with the analytical result.
Similar to observables, <code class="docutils literal notranslate"><span class="pre">SignalPDF</span></code> objects can be plotted as a function of a single kinematic variable,
while keeping all other kinematic variables fixed. The latter is achieved via the <code class="docutils literal notranslate"><span class="pre">kinematics</span></code> key.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;plot&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$q^2$&#39;</span><span class="p">,</span> <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\textnormal</span><span class="si">{GeV}</span><span class="s1">^2$&#39;</span><span class="p">,</span> <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">11.60</span><span class="p">]</span> <span class="p">},</span>
        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$P(q^2)$&#39;</span><span class="p">,</span>                               <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.25</span><span class="p">]</span> <span class="p">},</span>
        <span class="s1">&#39;legend&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="s1">&#39;upper left&#39;</span> <span class="p">}</span>
    <span class="p">},</span>
    <span class="s1">&#39;contents&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;samples ($\ell=\mu$)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;histogram&#39;</span><span class="p">,</span>
            <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="n">mu_samples</span> <span class="p">},</span>
            <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;C0&#39;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;samples ($\ell=\tau$)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;histogram&#39;</span><span class="p">,</span>
            <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="n">tau_samples</span> <span class="p">},</span>
            <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;C1&#39;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;PDF ($\ell=\mu$)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;signal-pdf&#39;</span><span class="p">,</span>
            <span class="s1">&#39;pdf&#39;</span><span class="p">:</span> <span class="s1">&#39;B-&gt;Dlnu::dGamma/dq2;l=mu&#39;</span><span class="p">,</span>
            <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;q2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">11.60</span><span class="p">],</span>
            <span class="s1">&#39;kinematics&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;q2_min&#39;</span><span class="p">:</span>  <span class="mf">0.02</span><span class="p">,</span>
                <span class="s1">&#39;q2_max&#39;</span><span class="p">:</span> <span class="mf">11.60</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;C0&#39;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;PDF ($\ell=\tau$)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;signal-pdf&#39;</span><span class="p">,</span>
            <span class="s1">&#39;pdf&#39;</span><span class="p">:</span> <span class="s1">&#39;B-&gt;Dlnu::dGamma/dq2;l=tau&#39;</span><span class="p">,</span>
            <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;q2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.17</span><span class="p">,</span> <span class="mf">11.60</span><span class="p">],</span>
            <span class="s1">&#39;kinematics&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;q2_min&#39;</span><span class="p">:</span>  <span class="mf">3.17</span><span class="p">,</span>
                <span class="s1">&#39;q2_max&#39;</span><span class="p">:</span> <span class="mf">11.60</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;C1&#39;</span>
        <span class="p">},</span>
    <span class="p">]</span>
<span class="p">}</span>
<span class="n">eos</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">plot_args</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>The result looks like this:</p>
<a class="reference internal image-reference" href="images/use-cases_simulation_hist-vs-plot.png"><img alt="images/use-cases_simulation_hist-vs-plot.png" src="images/use-cases_simulation_hist-vs-plot.png" style="width: 600px;" /></a>
<p>As you can see, we have excellent agreement between our simulations and the respective analytic expressions for the PDFs.</p>
</section>
<section id="constructing-a-4d-pdf-and-simulating-pseudo-events">
<h3>Constructing a 4D PDF and Simulating Pseudo Events<a class="headerlink" href="#constructing-a-4d-pdf-and-simulating-pseudo-events" title="Permalink to this headline"></a></h3>
<p>We can also draw samples for PDFs with more than two kinematic variables. Here, we
use the full four-dimensional PDF for <span class="math notranslate nohighlight">\(\bar{B}\to D^*\ell^-\bar\nu\)</span> decays.</p>
<p>We declare and initialize all four kinematic variables (<code class="docutils literal notranslate"><span class="pre">q2</span></code>, <code class="docutils literal notranslate"><span class="pre">cos(theta_l)</span></code>, <code class="docutils literal notranslate"><span class="pre">cos(theta_d)</span></code>, and <code class="docutils literal notranslate"><span class="pre">phi</span></code>),
and provide the phase space boundaries (same names appended with <code class="docutils literal notranslate"><span class="pre">_min</span></code> and <code class="docutils literal notranslate"><span class="pre">_max</span></code>).</p>
<p>We then produce the samples as for the 1D PDF.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dstarlnu_kinematics</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">Kinematics</span><span class="p">(</span><span class="o">**</span><span class="p">{</span>
    <span class="s1">&#39;q2&#39;</span><span class="p">:</span>            <span class="mf">2.0</span><span class="p">,</span>  <span class="s1">&#39;q2_min&#39;</span><span class="p">:</span>            <span class="mf">0.02</span><span class="p">,</span>     <span class="s1">&#39;q2_max&#39;</span><span class="p">:</span>           <span class="mf">10.5</span><span class="p">,</span>
    <span class="s1">&#39;cos(theta_l)&#39;</span><span class="p">:</span>  <span class="mf">0.0</span><span class="p">,</span>  <span class="s1">&#39;cos(theta_l)_min&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>      <span class="s1">&#39;cos(theta_l)_max&#39;</span><span class="p">:</span> <span class="o">+</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="s1">&#39;cos(theta_d)&#39;</span><span class="p">:</span>  <span class="mf">0.0</span><span class="p">,</span>  <span class="s1">&#39;cos(theta_d)_min&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>      <span class="s1">&#39;cos(theta_d)_max&#39;</span><span class="p">:</span> <span class="o">+</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="s1">&#39;phi&#39;</span><span class="p">:</span>           <span class="mf">0.3</span><span class="p">,</span>  <span class="s1">&#39;phi_min&#39;</span><span class="p">:</span>           <span class="mf">0.0</span><span class="p">,</span>      <span class="s1">&#39;phi_max&#39;</span><span class="p">:</span>           <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="p">})</span>
<span class="n">dstarlnu_pdf</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">SignalPDF</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;B-&gt;D^*lnu::d^4Gamma&#39;</span><span class="p">,</span> <span class="n">eos</span><span class="o">.</span><span class="n">Parameters</span><span class="p">(),</span> <span class="n">dstarlnu_kinematics</span><span class="p">,</span> <span class="n">eos</span><span class="o">.</span><span class="n">Options</span><span class="p">())</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">mtrand</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">74205</span><span class="p">)</span>
<span class="n">dstarlnu_samples</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">dstarlnu_pdf</span><span class="o">.</span><span class="n">sample_mcmc</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pre_N</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">preruns</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
</pre></div>
</div>
<p>We can now show correlations of the kinematic variables by plotting 2D histograms, beginning with <span class="math notranslate nohighlight">\(q^2\)</span> vs <span class="math notranslate nohighlight">\(\cos\theta_\ell\)</span>, …</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;plot&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$q^2$&#39;</span><span class="p">,</span> <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\textnormal</span><span class="si">{GeV}</span><span class="s1">^2$&#39;</span><span class="p">,</span> <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.50</span><span class="p">]</span> <span class="p">},</span>
        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$cos(\theta_\ell)$&#39;</span><span class="p">,</span>                     <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>  <span class="o">+</span><span class="mf">1.0</span><span class="p">]</span> <span class="p">},</span>
        <span class="s1">&#39;legend&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="s1">&#39;upper left&#39;</span> <span class="p">}</span>
    <span class="p">},</span>
    <span class="s1">&#39;contents&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;samples ($\ell=\mu$)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;histogram2D&#39;</span><span class="p">,</span>
            <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="n">dstarlnu_samples</span><span class="p">[:,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
            <span class="p">},</span>
            <span class="s1">&#39;bins&#39;</span><span class="p">:</span> <span class="mi">40</span>
        <span class="p">},</span>
    <span class="p">]</span>
<span class="p">}</span>
<span class="n">eos</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">plot_args</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>… over <span class="math notranslate nohighlight">\(\cos\theta_\ell\)</span> vs <span class="math notranslate nohighlight">\(\cos\theta_D\)</span> …</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;plot&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$cos(\theta_\ell)$&#39;</span><span class="p">,</span>                     <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>  <span class="o">+</span><span class="mf">1.0</span><span class="p">]</span> <span class="p">},</span>
        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$cos(\theta_D)$&#39;</span><span class="p">,</span>                        <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>  <span class="o">+</span><span class="mf">1.0</span><span class="p">]</span> <span class="p">},</span>
        <span class="s1">&#39;legend&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="s1">&#39;upper left&#39;</span> <span class="p">}</span>
    <span class="p">},</span>
    <span class="s1">&#39;contents&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;samples ($\ell=\mu$)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;histogram2D&#39;</span><span class="p">,</span>
            <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="n">dstarlnu_samples</span><span class="p">[:,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>
            <span class="p">},</span>
            <span class="s1">&#39;bins&#39;</span><span class="p">:</span> <span class="mi">40</span>
        <span class="p">},</span>
    <span class="p">]</span>
<span class="p">}</span>
<span class="n">eos</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">plot_args</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>… to <span class="math notranslate nohighlight">\(q^2\)</span> vs <span class="math notranslate nohighlight">\(\phi\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;plot&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$q^2$&#39;</span><span class="p">,</span> <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\textnormal</span><span class="si">{GeV}</span><span class="s1">^2$&#39;</span><span class="p">,</span> <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.70</span><span class="p">]</span> <span class="p">},</span>
        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;$\phi$&#39;</span><span class="p">,</span>                                 <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">6.28</span><span class="p">]</span> <span class="p">},</span>
        <span class="s1">&#39;legend&#39;</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="s1">&#39;upper left&#39;</span> <span class="p">}</span>
    <span class="p">},</span>
    <span class="s1">&#39;contents&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;samples ($\ell=\mu$)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;histogram2D&#39;</span><span class="p">,</span>
            <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="n">dstarlnu_samples</span><span class="p">[:,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>
            <span class="p">},</span>
            <span class="s1">&#39;bins&#39;</span><span class="p">:</span> <span class="mi">40</span>
        <span class="p">},</span>
    <span class="p">]</span>
<span class="p">}</span>
<span class="n">eos</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">plot_args</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>The results look as follows:</p>
<a class="reference internal image-reference" href="images/use-cases_simulation_hist2d-0-1.png"><img alt="images/use-cases_simulation_hist2d-0-1.png" src="images/use-cases_simulation_hist2d-0-1.png" style="width: 600px;" /></a>
<a class="reference internal image-reference" href="images/use-cases_simulation_hist2d-1-2.png"><img alt="images/use-cases_simulation_hist2d-1-2.png" src="images/use-cases_simulation_hist2d-1-2.png" style="width: 600px;" /></a>
<a class="reference internal image-reference" href="images/use-cases_simulation_hist2d-0-3.png"><img alt="images/use-cases_simulation_hist2d-0-3.png" src="images/use-cases_simulation_hist2d-0-3.png" style="width: 600px;" /></a>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="basics.html" class="btn btn-neutral float-left" title="Basics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="advanced.html" class="btn btn-neutral float-right" title="Advanced Usage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2021, Danny van Dyk and others.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>